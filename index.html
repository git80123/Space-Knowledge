<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>å¤ªç©ºæ¢ç´¢</title>
  <style>
    body { font-family: sans-serif; background: #000; color: #fff; text-align: center; padding: 2em; }
    input { padding: 0.5em; font-size: 1em; width: 300px; }
    button { padding: 0.5em 1em; font-size: 1em; margin-left: 1em; }
    #result, #nasa-apod-result, #mars-result, #asteroid-result, #epic-result {
      margin-top: 2em; text-align: left; max-width: 600px; margin-left: auto; margin-right: auto;
    }
    img { max-width: 100%; display: block; margin: 1em auto; }
    .nasa-section { background: #111; border-radius: 10px; margin: 2em auto; max-width: 700px; padding: 2em 1em; box-shadow: 0 0 10px #222; }
    h2 { margin-bottom: 0.25em; }
    label { display: block; margin: 0.5em 0 0.2em 0;}
    select { padding: 0.5em; font-size: 1em; width: 300px;}
  </style>
</head>
<body>
  <h1>ğŸŒŒ å¤ªç©ºæ¢ç´¢çŸ¥è¯†ç½‘ç«™</h1>
  <p>è¯·è¾“å…¥å…³é”®è¯ï¼ˆä¾‹å¦‚ï¼šå¤ªé˜³ã€ç«æ˜Ÿã€é»‘æ´ï¼‰</p>
  <input type="text" id="keyword" placeholder="è¾“å…¥å¤ªç©ºç›¸å…³è¯è¯­" />
  <button onclick="search()">æœç´¢</button>
  <div id="result"></div>

  <!-- NASA å…¬å…± API åˆ†åŒº -->
  <div class="nasa-section">
    <h2>NASA æ¯æ—¥å¤©æ–‡å›¾ç‰‡ï¼ˆAPODï¼‰</h2>
    <label>é€‰æ‹©æ—¥æœŸï¼ˆå¯é€‰ï¼‰ï¼š<input type="date" id="apod-date" max="" /></label>
    <button onclick="searchApod()">è·å–å›¾ç‰‡</button>
    <div id="nasa-apod-result"></div>
  </div>

  <div class="nasa-section">
    <h2>ç«æ˜Ÿæ¢æµ‹è½¦ç…§ç‰‡</h2>
    <label>é€‰æ‹©æ¢æµ‹è½¦:
      <select id="mars-rover">
        <option value="curiosity">Curiosityï¼ˆå¥½å¥‡å·ï¼‰</option>
        <option value="opportunity">Opportunityï¼ˆæœºé‡å·ï¼‰</option>
        <option value="spirit">Spiritï¼ˆå‹‡æ°”å·ï¼‰</option>
      </select>
    </label>
    <label>ç«æ˜Ÿæ—¥(Sol, 0~3000): <input type="number" id="mars-sol" min="0" max="3000" value="1000"></label>
    <button onclick="searchMars()">è·å–ç…§ç‰‡</button>
    <div id="mars-result"></div>
  </div>

  <div class="nasa-section">
    <h2>è¿‘åœ°å°è¡Œæ˜Ÿï¼ˆNeoWsï¼‰</h2>
    <label>èµ·å§‹æ—¥æœŸ: <input type="date" id="asteroid-start" /></label>
    <label>ç»“æŸæ—¥æœŸ: <input type="date" id="asteroid-end" /></label>
    <button onclick="searchAsteroid()">æŸ¥è¯¢å°è¡Œæ˜Ÿ</button>
    <div id="asteroid-result"></div>
  </div>

  <div class="nasa-section">
    <h2>åœ°çƒå¤šè‰²æˆåƒï¼ˆEPICï¼‰</h2>
    <button onclick="searchEpic()">æ˜¾ç¤ºæœ€è¿‘åœ°çƒç…§ç‰‡</button>
    <div id="epic-result"></div>
  </div>

  <script>
    // ç»´åŸºç™¾ç§‘æœç´¢ï¼ˆä¿ç•™åŸä»£ç ï¼‰
    async function search() {
      const input = document.getElementById('keyword').value;
      const resultDiv = document.getElementById('result');
      if (!input) return resultDiv.innerHTML = "<p>è¯·è¾“å…¥å…³é”®è¯ã€‚</p>";
      
      const response = await fetch("https://zh.wikipedia.org/api/rest_v1/page/summary/" + encodeURIComponent(input));
      if (response.ok) {
        const data = await response.json();
        resultDiv.innerHTML = '<h2>' + data.title + '</h2><p>' + data.extract + '</p>';
      } else {
        resultDiv.innerHTML = "<p>æœªæ‰¾åˆ°ç›¸å…³ä¿¡æ¯ã€‚</p>";
      }
    }

    // è®¾ç½®æ—¥æœŸæœ€å¤§å€¼ä¸ºä»Šå¤©
    document.getElementById('apod-date').max = new Date().toISOString().split('T')[0];
    document.getElementById('asteroid-start').max = document.getElementById('asteroid-end').max = new Date().toISOString().split('T')[0];

    // NASA APOD
    async function searchApod() {
      const date = document.getElementById('apod-date').value;
      let url = 'https://api.nasa.gov/planetary/apod?api_key=DEMO_KEY';
      if (date) url += `&date=${date}`;
      const div = document.getElementById('nasa-apod-result');
      div.innerHTML = 'åŠ è½½ä¸­...';
      try {
        const res = await fetch(url);
        if (!res.ok) throw new Error();
        const data = await res.json();
        let media = '';
        if (data.media_type === 'image') {
          media = `<img src="${data.url}" alt="APOD" />`;
        } else if (data.media_type === 'video') {
          media = `<iframe src="${data.url}" height="400"></iframe>`;
        }
        div.innerHTML = `<h3>${data.title}</h3>${media}<p>${data.explanation}</p><p>ç‰ˆæƒ: ${data.copyright || 'Public Domain'}</p>`;
      } catch {
        div.innerHTML = 'å›¾ç‰‡è·å–å¤±è´¥ï¼Œè¯·ç¨åå†è¯•ã€‚';
      }
    }

    // NASA Mars Rover
    async function searchMars() {
      const rover = document.getElementById('mars-rover').value;
      const sol = document.getElementById('mars-sol').value;
      const url = `https://api.nasa.gov/mars-photos/api/v1/rovers/${rover}/photos?sol=${sol}&api_key=DEMO_KEY`;
      const div = document.getElementById('mars-result');
      div.innerHTML = 'åŠ è½½ä¸­...';
      try {
        const res = await fetch(url);
        if (!res.ok) throw new Error();
        const data = await res.json();
        if (data.photos && data.photos.length > 0) {
          div.innerHTML = '';
          data.photos.slice(0, 5).forEach(photo => {
            div.innerHTML += `<p><b>${photo.camera.full_name}</b> æ‹æ‘„äº ${photo.earth_date}</p><img src="${photo.img_src}" alt="Mars Rover Photo" />`;
          });
        } else {
          div.innerHTML = 'æ­¤ Sol æ²¡æœ‰ç…§ç‰‡ï¼Œè¯·å°è¯•å…¶å®ƒæ•°å€¼ã€‚';
        }
      } catch {
        div.innerHTML = 'ç…§ç‰‡è·å–å¤±è´¥ï¼Œè¯·ç¨åå†è¯•ã€‚';
      }
    }

    // NASA Asteroids
    async function searchAsteroid() {
      const start = document.getElementById('asteroid-start').value;
      const end = document.getElementById('asteroid-end').value;
      const div = document.getElementById('asteroid-result');
      if (!start || !end) {
        div.innerHTML = 'è¯·é€‰æ‹©æ—¥æœŸã€‚';
        return;
      }
      div.innerHTML = 'åŠ è½½ä¸­...';
      const url = `https://api.nasa.gov/neo/rest/v1/feed?start_date=${start}&end_date=${end}&api_key=DEMO_KEY`;
      try {
        const res = await fetch(url);
        if (!res.ok) throw new Error();
        const data = await res.json();
        let html = '';
        Object.values(data.near_earth_objects).forEach((objs, i) => {
          objs.forEach(obj => {
            html += `<p>
              <b>${obj.name}</b> ï¼ˆç¼–å·: ${obj.id}ï¼‰<br>
              å±é™©: ${obj.is_potentially_hazardous_asteroid ? 'æ˜¯' : 'å¦'}<br>
              æœ€è¿‘è·ç¦»åœ°çƒ: ${Number(obj.close_approach_data[0].miss_distance.kilometers).toLocaleString()} km<br>
              ç›´å¾„: ${obj.estimated_diameter.meters.estimated_diameter_min.toFixed(0)} ~ ${obj.estimated_diameter.meters.estimated_diameter_max.toFixed(0)} ç±³</p>`;
          });
        });
        div.innerHTML = html || 'è¯¥æ—¥æœŸå†…æ²¡æœ‰è®°å½•åˆ°è¿‘åœ°å°è¡Œæ˜Ÿã€‚';
      } catch {
        div.innerHTML = 'å°è¡Œæ˜Ÿæ•°æ®è·å–å¤±è´¥ã€‚';
      }
    }

    // NASA EPIC
    async function searchEpic() {
      const div = document.getElementById('epic-result');
      div.innerHTML = 'åŠ è½½ä¸­...';
      try {
        const resp = await fetch('https://api.nasa.gov/EPIC/api/natural?api_key=DEMO_KEY');
        if (!resp.ok) throw new Error();
        const data = await resp.json();
        if (!data.length) { div.innerHTML = "æš‚æ— å›¾ç‰‡"; return; }
        const dateObj = data[0].date.split(' ')[0].replace(/-/g,'/');
        let imgsHtml = '';
        data.slice(0, 5).forEach(img => {
          const imgUrl = `https://epic.gsfc.nasa.gov/archive/natural/${dateObj}/jpg/${img.image}.jpg`;
          imgsHtml += `<p>${img.date}</p><img src="${imgUrl}" alt="EPIC Earth" />`;
        });
        div.innerHTML = imgsHtml;
      } catch {
        div.innerHTML = 'åœ°çƒå›¾ç‰‡è·å–å¤±è´¥ã€‚';
      }
    }
  </script>
</body>
</html>
